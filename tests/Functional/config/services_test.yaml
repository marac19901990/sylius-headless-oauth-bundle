services:
    _defaults:
        autowire: true
        autoconfigure: true
        public: true

    # Test Customer Factory
    test.factory.customer:
        class: Marac\SyliusHeadlessOAuthBundle\Tests\Functional\Factory\TestCustomerFactory

    # Test ShopUser Factory
    test.factory.shop_user:
        class: Marac\SyliusHeadlessOAuthBundle\Tests\Functional\Factory\TestShopUserFactory

    # Test Customer Repository
    test.repository.customer:
        class: Marac\SyliusHeadlessOAuthBundle\Tests\Functional\Repository\TestCustomerRepository
        arguments:
            - '@doctrine'

    # Mock HTTP Client - replaces the bundle's OAuthHttpClient with a mock
    Marac\SyliusHeadlessOAuthBundle\Http\OAuthHttpClient:
        class: GuzzleHttp\Client
        factory: ['Marac\SyliusHeadlessOAuthBundle\Tests\Functional\Mock\MockHttpClientFactory', 'createClient']
        public: true

    # Alias Sylius services to test services
    sylius.repository.customer:
        alias: test.repository.customer

    sylius.factory.customer:
        alias: test.factory.customer

    sylius.factory.shop_user:
        alias: test.factory.shop_user
